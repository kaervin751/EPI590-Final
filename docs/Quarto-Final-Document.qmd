---
title: "Epi 590R Final Project (Olympics)"
author: "Kourtney Ervin"
format: html
editor: visual
execute: 
  warning: false
  echo: false
---

## R Final Project - Kourtney Ervin

```{r}
#| label: Reading in Data
library(tidyverse)
library(here)
library(gtsummary)

medal_cols <- c("id", "name", "sex", "age", "height", "weight", "team", "NOC", "games",
								"year", "season", "city", "sport", "event", "medal")
medals <- read_csv(here::here("data", "raw","athlete_events.csv"),
									 skip = 1, col_names = medal_cols)
```

**Question 1**

Creating a descriptive Table 1

```{r}
#| label: tbl-one
#| tbl-cap: "Descriptive Table"
table1 <- tbl_summary(
	medals,
	by = sex,
	include = c(NOC, season, height, weight),
	label = list(
		NOC ~ "Country",
		season ~ "Summer/Winter",
		height ~ "Height",
		weight ~ "Weight"
	),
	missing_text = "Missing")|>
	add_p(test = list(all_continuous () ~ "t.test",
										all_categorical() ~ "chisq.test"))|>
	add_overall(col_label = "**Total**|>")|>
	bold_labels()|>
	modify_footnote(update = everything() ~ NA)|>
	modify_header(label = "**Variable**", p.value = "**P**")
table1
```

@tbl-one is a descriptive table giving the distribution of countries, height, and weight of Olympic Athletes separated by sex and with a total column.

The mean (standard deviation) of female Olympians is `r inline_text(table1, variable = "weight", column = "stat_1")` centimeters.

**Question 2**

Fitting a regression model and creating the table

```{r}
#| label: tbl-two
#| tbl-cap: "Regression Table"
linear_mod <- lm(age ~ height + weight, data = medals)
tbl_regression(
	linear_mod,
	intercept = TRUE)
```

**Question 3**

Creating a histogram and adding a chance to show the mean and standard deviation.

```{r}
#|label: fig-one
#|fig-cap: "A histogram showing the distribution of heights of Olympic athletes, both male and female"
hist(medals$height,
		 main = "Frequency of height of Olympians",
		 xlab = "Height in cm",
		 ylab = "Frequency"
		 )
meanheight <- mean(medals$height, na.rm = TRUE)
stddevheight <- sd(medals$height, na.rm = TRUE)
```

@fig-one is a histogram showing the distribution of height frequency of Olympians both male and female combined. 
The mean height showed by the mean function is `r meanheight` in centimeters. The standard deviation is `r stddevheight`.

**Question 4**

Creating and using my function to find the mean of height or weight, depending on what you set to x.

```{r}
#|label: new-mean
x <- medals$height

new_mean <- function(x){
	n <- length(na.omit(x))
	mean_val <- sum(x, na.rm = TRUE)/n
	return(mean_val)}

new_dev <- function(x){
	output <- sd(x, na.rm=TRUE)
	return(output)
}

new_mean(x)
```

I understand this is similar to what we did in class, but I did have to add to it to make sure the NA in the data set were not included.
